# PenTest + Exam Prep
## Lesson 1 - Scoping Organization/Customer Requirements

### Standard Process

1. **Planning**

2. **Reconnaissance** is next and focuses on gathering as much information about the target as possible. This process includes searching information on the Internet, using Open-Source Information Gathering Tools (OSINT), and websites.

3. **Scanning** is a critical phase as it provides more information about available network resources. Scanning identifies live hosts, listening ports, and running services.

4. **Gaining access** occurs after the team has gathered information on the network. In this phase, the team will attempt to gain access to the system, to see how deep into the network they can travel.

5. **Analysis** occurs after the team has completed the exercise, and will go through the results of all activities, analyze the findings, and derive a summary of their risk rating.

- To learn more about the vulnerabilities, you can often click on CVE names, which have hyperlinks to the record in the **National Vulnerability Database (NVD)**. Once there, you can read more details.

- As vulnerabilities are identified, they are first rated as to the severity using the Common **Vulnerability Scoring System (CVSS).** The score is derived using a set of metrics, which helps in prioritizing vulnerabilities.

- The information from the CVSS is fed into the **Common Vulnerabilities and Exposures (CVE).** The CVE is a listing of all publicly disclosed vulnerabilities.

- **The ISSAF** contains a list of 14 documents that relate to PenTesting, such as guidelines on business continuity and disaster recovery along with legal and regulatory compliance

**The Penetration Testing Execution Standard (PTES)** has seven main sections that provide a comprehensive overview of the proper structure of a complete PenTest. Some of the sections include details on topics such as pre-engagement interactions, threat modeling, vulnerability analysis, exploitation, and reporting.

The **Open Web Application Security Project (OWASP)** is an organization aimed at increasing awareness of web security and provides a framework for testing during each phase of the software development process.

**OSSTMM** provides a holistic structured approach to PenTesting. Written in 2000, the open-source document stresses auditing, validation, and verification.

Computerized electronic patient records are referred to as **electronic protected health information (e-PHI).** With HIPAA, the **e-PHI** of any patient must be protected from exposure, or the organization can face a hefty fine.

**The Health Insurance Portability and Accountability Act (HIPAA)** is a law that mandates rigorous requirements for anyone that deals with patient information.

**The California Consumer Privacy Act (CCPA)** was enacted in 2020 and outlines specific guidelines on how to appropriately handle consumer data.

In 2018 the EU enacted the **General Data Protection Regulation (GDPR)**, which outlines specific requirements on how consumer data is protected. 

*NIST* has many resources for cybersecurity professionals that include the Special Publication (SP) 800 series, which deals with cybersecurity policies, procedures, and guidelines.

### PCI Compliance

**The levels are as follows:**

    Level 1 - is a large merchant with over six million transactions a year.
    Level 2 - is a merchant with one to six million transactions a year.
    Level 3 - is a merchant with 20,000 to one million transactions a year.
    Level 4  -is a small merchant with under 20,000 transactions a year.

The activity required for each level to prove compliance with the guidelines, is as follows:

    **Level 1—** must have an external auditor perform the assessment by an approved Qualified Security Assessor (QSA).

    **Levels 1 and 2** must complete a RoC.

    **Levels 2– 4** —can either have an external auditor or submit a self-test that proves they are taking active steps to secure the infrastructure.

In addition to PCI DSS, there are several laws in the United States and the European Union (EU) that deal with the protection of consumer data.

 One such law is GDPR, which has a global reach.

### Dissecting GDPR

In 2018 the EU enacted the General Data Protection Regulation (GDPR), which outlines specific requirements on how consumer data is protected. The law affects anyone who does business with residents of the EU and Britain. This comprehensive law focuses on the privacy of consumer data and, more importantly, gives consumers the ability to control how their data is handled.

**Some of the components of this law include:**

    **REQUIRE CONSENT** - if a company wants to gather information on your searching and buying patterns, it must first obtain permission. A client must be allowed to accept or decline for each separate data source , i.e., email addresses for marketing or IP addresses for analytics.

    **RESCIND CONSENT** —just as the consumer can give consent for a company to use their information, they can opt out at any time. Known as the right to be forgotten rule, this puts control back in the hands of the consumer.

    **GLOBAL REACH** — the GDPR affects anyone who does business with residents of the EU and Britain. The statute relates to e-commerce, as websites do not have a physical boundary. If you do business with anyone in the EU and Britain, this rule will prevail.
    
    **RESTRICT DATA COLLECTION** —organizations should collect only the minimal amount of data that is needed to interact with the site.
    
    **VIOLATION REPORTING** — if the company’s consumer database is compromised, they must report the breach within 72 hours.

## Lesson 2 - Defining Rules of Engageent

<ins>STANDARDS

- **DRIVERS** - **The Driver's Privacy Protection Act (DPPA)**
governs the privacy and disclosure of personal information gathered by state Departments of Motor Vehicles.

- **FINANCE** - **The Gramm-Leach-Bliley Act (GLBA)** requires financial institutions to ensure the security and confidentiality of client information and take steps to keep customer information secure.

- **PEN TESTING** - **The Penetration Testing Execution Standard (PTES**) was developed by business professionals as a best practice guide to PenTesting. The PTES approaches the standard business aspect in that it doesn't have technical guidelines specifically addressed in the document.

- **PEN TESTING** - **Open-Source Security Testing Methodology Manual (OSSTMM)** provides a holistic structured approach to PenTesting. Written in 2000, the open-source document stresses auditing, validation, and verification.

- **MEDICAL/HEALTH** - **The Health Insurance Portability and Accountability Act (HIPAA)** Privacy Rule establishes national standards to protect the privacy of individuals' medical records.

- **PENT TESTING**- **The ISSAF** contains a list of 14 documents that relate to PenTesting, such as guidelines on business continuity and disaster recovery along with legal and regulatory compliance.

<ins>Engagement Agreements

- **ADDITIONAL CHARGES** - **The Master Service Agreement (MSA**) is a contract that establishes guidelines for any business documents executed between two parties. It can be used to cover recurring costs and any unforeseen additional charges.

- **EXPECTATIONS** - **The Statement of Work (SOW)** is a document that defines the expectations for a specific business arrangement. It typically includes a list of deliverables, responsibilities of both parties, and others.

- **MILESTONES/TERMINATION** - **A service-level agreement (SLA)** is a contract that outlines the detailed terms under which a service is provided, including reasons the contract may be terminated.

## Lesson 3- Footprinting & Gathering Intelligence
**VOIP** - **Service (SRV)** record provides host and port information on services such as voice over IP (VoIP) and instant messaging (IM).

**Text (TXT)** record provides information about a resource such as a server or network in human readable form.

**Nameserver (NS)** record lists the authoritative DNS server for a particular domain. A standard DNS query will use DNS servers to identify the Internet Protocol (IP) address behind a particular domain or resource name.

**Mail Exchange (MX)** record provides the mail server that accepts email messages for a particular domain.

## Question
**Question-**
A security analyst is trying to find older versions of a company's website which contained sensitive information. They are worried that attackers might still be able to find older versions, so they want to try using web search commands. Which web search command would help them search?

Use a standard **cache** search on a site, and you will see a recent view of the website. To do a quick check simply type cache: in the address bar. For example, cache:https://comptia.org.

**inanchor** searches anchor text. For example, use inanchor:Certification report to search for any pages whose anchor text includes the text "Certification" and have the text "report" anywhere on the page.

One would use **inurl:Certification report** to search for any pages whose URLs include the text "Certification" and have the text "report" anywhere on the page.

The security professional would enter the **site:comptia.org** report to search CompTIA's website only for results including the text "report."

***Question-***

A security researcher wants to scan documents against a website for only pdf documents. What metagoofil parameter could they use?

**PDF** - **metagoofil -t** pdf scans for pdf documents. Metagoofil scrapes the metadata, and then displays the information using Hypertext Markup Language (HTML).

**DOCUMENTS** - **metagoofil -d** comptia.org scans for documents on Comptia.org. Metagoofil uses various python libraries such as PdfMiner, GoogleSearch, and Hachoir.

**LIST** - **metagoofil -l 75** searches for 75 documents. The output can then be viewed in a standard browser. Another valuable tool is FOCA, which can discover metadata from a variety of sources.

**DOWNLADD** - **metagoofil -n 25** downloads 25 files. You can download a copy of Metagoofil from GitHub. In addition, the tool is built into Kali Linux. 

***Question-***

**CERTS** - The **Certification Revocation List (CRL)** is a list of certificates that in some way have been deemed invalid. Although effective, most online services have moved to the newer OCSP to check the validity of the certificate.

**Network Connections (ncpa.cpl)** is a Control Panel applet for managing adapter devices, including IP address information.

A more useful field in a digital certificate from a reconnaissance perspective is the **subject alternative name (SAN). SANs** can identify specific subdomains that can be covered by the certificate.

**The Social Engineering Toolkit (SET)** is a Python-based collection of tools that can be used when conducting a social engineering PenTest.

The **robots.txt** file is the most common and effective way to prevent search engine crawlers from indexing or accessing specific pages or directories. A robots.txt file can be easily created and updated as needed, and it is a standard method that is recognized by most bots and crawlers.
 
An **ACL** could be effective in restricting access to specific directories, but it may not be as easy to implement as using a robots.txt file.
 
**Blocking specific user agents** could work to prevent specific bots or crawlers from accessing the site, but it may not be as flexible or scalable as using a robots.txt file.
 
**Creating a noindex meta tag**on each page to be excluded would not prevent other types of bots or crawlers from accessing specific pages.

### <ins> Tools

**theHarvester** is an intuitive tool that can search a company's visible threat landscape. The tool gathers information on subdomain names, employee names, email addresses, PGP key entries, and open ports and service banners.

**Shodan** is a search engine designed to locate and index IoT devices that are connected to the Internet.

**Dirbuster** is specifically geared towards website enumeration. There are numerous tools and techniques available to evaluate a website.

**Metagoofil** uses various python libraries such as PdfMiner, GoogleSearch, and Hachoir to scrape the metadata, and then displays the information using Hypertext Markup Language (HTML). 

## Lesson 4- Evaulating Human and Physical Vulnerabilities

**DLINK Phones** - **intitle:"DPH" "web login setting"** it would be used to find information of D -Link Phones. If they don't have the password, they can search online for the default password to try on the targeted system.

**CISCO Call Manager    ** - **iinurl:"ccmuser/logon.asp"** it would be used to find Cisco CallManager instances. They can also try some other Google Hacking to find more information on VoIP phones that you can use to launch the attack.

**iintitle:"Grandstream Device Configuration"** i password would be used to find information about Grandstream phones.

**iinurl:"CallManager"** it would not be a valid instance of attempting to find CallManager instances, they would have to search for ccmuser.

## Lesson 5 - Preparing the Vulnerability Scan

### Vulnerability Lifecycle

1. Discover - finding a vulnerability
2. Coordinate - Mitigation phase
3. Manage- Patch has been released
4. Document - Final phase

**OPEN SOURCE - specific vulns** - **Nikto** is an open-source web server scanner that can complete comprehensive testing on web servers for a variety of vulnerabilities, such as anticlickjacking X-Frame-options header, and dangerous files and CGIs.

A team can run a vulnerability scan using the **Open Vulnerability Assessment Scanner. OpenVAS** will list the vulnerabilities along with a risk rating that summarizes the overall state of the site that was tested.

**SQLmap** is an open-source database scanner that searches for and exploits SQL injection flaws.

When testing for vulnerabilities, one tool the team can use is **Censys**, an attack surface analyzer, similar to Shodan, to identify exposed systems. 

**Hping3** is also a tool to craft and send a malformed packet to your target. For example, the Christmas (XMAS) scan might be able to bypass security mechanisms that follow strict interpretation of RFC 793.

### <ins> Active Reconnaissance
 <ins>**Grabbing Banners**

Banner Grabbing is a technique used during reconnaissance to gather information about network hosts and the services running on open ports. The process involves attempting to open a session with a service and getting the service to identify itself.

You can use **Wget**, **Netcat**, and other tools to grab banners from services and protocols such as FTP, SSH, HTTP, SMTP, POP3, DNS, Telnet, Microsoft netbios-ssn, and more. Acquiring these banners can help you focus your attacks on specific services.

**The following are some examples of banner grabbing:**

Wget can be used to grab a banner using the following syntax: 

```wget <target IP> -S.``` When using this command, -S will print the HTTP headers that are sent by the server.

Another option is netcat (nc), a popular tool for Unix and Linux.

<ins>**Running Scans**

Scanning Considerations:

- **Time to run scans** —Some vulnerability scans take a great deal of time to run, such as web app scans, which can take days. You may need to configure the run of the scan at a more superficial level. You can also set the scan to stop scanning after a certain amount of time or when you get a satisfactory number of results.

- **Bandwidth limitations** —Intensive scans can consume a significant amount of bandwidth, especially if several concurrent scans are running against multiple hosts. This can delay the scans or disrupt them entirely.

- **Fragile systems**—Some systems, such as a legacy server or nontraditional assets such as Internet of Things (IoT) devices, may not be able to withstand an intensive scan. In addition, in most cases the team should use caution when scanning printers, as the scan may cause a printer to print out random data and waste a great deal of paper.

- **Query throttling** —The number of queries launched by the scanner in order to overcome bandwidth limitations can be throttled. In addition, it can help avoid issues with fragile systems and other non-traditional assets that have weak or outdated hardware or are inherently unstable.

<ins>Packet crafting involves four stages:

- **Assemble** — create the packet to be sent.
- **Edit** — modify the contents of a created or captured packet.
- **Play** — send/resend -  a packet on the network.
- **Decode** - —capture and analyze traffic generated using a packet analyzer such as Wireshark.

You can craft your packet(s) using the command line, GUI, or script options.

<ins>Some Packet Crafters Include:

**Scapy** - is a tool to craft and send a malformed packet to your target. The type of packet crafted will be dependent on security products and rules.

**Hping3** -is also a tool to craft and send a malformed packet to your target. For example, the Christmas (XMAS) scan might be able to bypass security mechanisms that follow strict interpretation of RFC 793.

<ins>Avoiding Antivirus

Obfuscating a known signature uses a tool such as **ObfuscatedEmpire** in a solution. It is a fork of Empire that has Invoke-Obfuscation baked directly into its functionality.

## Lesson 6 - Scanning Logical Vulnerabilities

**Predetermined Security Baseline** - **SCAP** - **The Security Content Automation Protocol (SCAP**) is a US standard used to ensure applications are in line with mandated security requirements.

**Vulns After it's in Prod** - **DAST** -  **Dynamic Application Security Testing (DAST)** is done after the code is placed in production. Unlike SAST, dynamic testing will unearth vulnerabilities that are evident after the code is in production.

**Early in Dev Cycyle** - **SAST** -  **Static Application Security Testing (SAST)** is done early in the software development life cycle to examine the code for security vulnerabilities.

**Vulns with Risk Rating** - **OpenVAS** - A team can run a vulnerability scan using the Open Vulnerability Assessment Scanner. OpenVAS will list the vulnerabilities along with a risk rating that summarizes the overall state of the site that was tested.


<ins> Active Reconnaissance

## Lesson 7 - Analyzing Scan Results

### NMAP

- **T0 and T1** are the best options for IDS evasion but are extremely SLOW. Aggressive scans can cause congestion and disrupt fragile systems.

- **T2** slows the scan to conserve bandwidth. In some cases, network devices enforce rate limiting, which limits the data flow by either policing or shaping the traffic.

- **T3** is the default and is the most stable option.

- **T4** is the recommended choice for a fast scan that is still relatively stable. Network performance is essential. If the target has a healthy amount of bandwidth, and the client agrees, the team can scan using multiple concurrent scanners.

- **TCP ACK-** - During host discovery, nmap sends a TCP ACK packet to port 80. A TCP ACK scan is used to bypass firewall rulesets, determine which ports are filtered, and if a firewall is stateful or not.
 
- **TCP SYN** - During host discovery, nmap sends a TCP SYN packet to port 443. This scan will send a TCP SYN to whatever port(s) you specify. If you don’t indicate a port number, nmap will try all ports and then display the findings.
 
- **"ping"** -  During host discovery, nmap sends an ICMP type 8 (echo request). This may be referred to as a "ping" sweep and implies that scanning will use Internet Control Message Protocol (ICMP) to discover hosts.
 
- **ARP requests** - During host discovery, nmap sends ARP requests to obtain MAC address details.

### How NMAP Determines the OS

- **Don't Fragment (DF) bit** - A component of how nmap determines the operating systems is the Don't Fragment (DF) bit. Is the DF bit in the IPv4 header on or off?

- **Window Size (WS)** - A component of how nmap determines the operating systems is the Window Size (WS). What does the OS use as a WS?

- **Time to Live (TTL)** - A component of how nmap determines the operating systems is the Time to Live (TTL). What is the TTL value set on the outbound packet?

### Saving NMAP Results

- **SAVE TO TEXT** - **Normal output (-oN)** - is similar to interactive; however, with this format, you can save the results of an Nmap scan to a text file for later analysis.

- **NO SWITCH NEEDED** - **Interactive output** - is a human readable output that you would normally see on the screen when you run a scan. This is the default output, so no switch is needed.

- **XML output (-oX)** -  is a format that can easily be analyzed by security automation tools, converted to HTML, imported into a database, or studied using Zenmap.

- **Grepable output (-oG)** -  creates a grepable friendly file that can be searched using grep, awk, cut, and diff.

### More NMAP Swtiches

-**-sA** - **Bypass Firewall** - **TCP ACK** -  scan is used to bypass firewall rulesets, determine which ports are filtered and if a firewall is stateful or not. This scan uses the option: -sA.

--**-sT** full (or TCP connect) scan will use a standard TCP three-way handshake. This scan uses the option: -sT.

-**-sS** - **When using Nmap, the **TCP SYN**  scan (-sS) is the default and most popular option. It can be performed quickly and is able to scan thousands of ports per second on a fast network not hampered by restrictive firewalls.

-**-sX** - Christmas tree scan sends a TCP segment with the FIN, PSH, and URG flags raised to bypass a firewall or IDS. This scan uses the option: -sX.

--**oX** - **XML output (-oX)** - is a format that can easily be analyzed by security automation tools, converted to HTML, imported into a database, or studied using Zenmap.

--**sU** - Nmap can run a **UDP scan** - using the option -sU. If the port is open, the target might return a UDP packet which provides proof that the port is open. However, if there is no response, the port is considered open or filtered.

## Lesson 8 - Avoiding Detection and Covering Tracks

- **Changing time values** - **TimeStomp** is possible by using Metasploit's meterpreter tool called TimeStomp which allows you to delete or modify timestamp-related information on files.

- **TimeStomp** is a tool inside of **meterpreter** which allows you to delete or modify timestamp-related information on files.

- **Shred** is a command built into Linux to make sure that files are securely deleted and completely removed. Windows doesn't have a built-in command-line equivalent to file-based shredding.

- **wevtutil** - **clear log entries** - When using the command-line interface (CLI) in Windows, you can also clear individual log categories. For example, wevtutil cl Application will clear the application log.

### Netcat

- **UDP** - **(-u)** parameter starts Netcat in UDP mode. The default is to use TCP. Netcat is a command-line utility used to read from or write to a TCP or UDP network connection.

- **Listen Mode** - **(-l)** The -l parameter starts Netcat in listen mode. The default mode is to act as a client.

- **Listen Harder (Windoows Only)**  - **(-L)** parameter starts Netcat in the Windows-only "listen harder" mode. This mode creates a persistent listener that starts listening again when the client disconnects.

- **Execute Program** - **(-e)** - parameter specifies the program to execute when a connection is made.

### Tools

-**Proxy servers** - **Socket Secure (SOCKS)** - are used on a network to mediate the communications between a client and another server. One method is to use Socket Secure (SOCKS).

-**masscan** is not a tool meant for inside networks. It is extremely noisy and was designed for scanning the internet rapidly. This could actually take down a network if not careful. 

-**Ostinato** uses **packet crafting** techniques as part of the attack. A more popular packet crafting tool is Scapy or hping3 which allows users to craft their own packets.

-**Snow** -  is a CLI steganography tool that conceals a data payload within the **whitespace** of a text file that uses the ASCII format.


## Lesson 9 - Exploring LAN and Cloud

- **Fake Web Connections** - **slowloris attack** - keeps multiple fake web connections open for as long as possible until the maximum number of allowed connections is reached.

- An **HTTP flood** - uses seemingly legitimate HTTP GET or POST requests to attack a web server. It does not require spoofing or malformed packets but can consume a high number of resources with a single request.

- A **DNS amplification** - attack uses multiple public DNS servers to receive spoofed queries and respond to a target.

- **Prowler** - **AWS** is an audit tool for use with Amazon Web Services only. It can be used to evaluate cloud infrastructure against the Center for Internet Security (CIS) benchmarks.

### Types of Tools

- **Cobalt Strike** - is a commercial version of Armitage with advanced features and reporting. Armitage itself is an intuitive GUI for the Metasploit framework.

- **Metasploit Pro** - is a full-featured graphical version that includes Quick Start wizards, easy vulnerability scanning and validation, phishing campaigns, and reporting.

- **Responder** - is a **man-in-the-middle** type tool that can be used to exploit name resolution on a Windows network.
    - Responder is a man-in-the-middle type tool that can be used to exploit name resolution on a Windows network which poisons LLMNR.
    - Responder is also designed to intercept and poison NBT-NS. Once a request is intercepted, Responder will return the attacker's host IP as the name record.

- **Packet Crafting** - **Ostinato** uses packet crafting techniques as part of the attack. A more popular packet crafting tool is Scapy or hping3 which allows users to craft their own packets.

### On-Path Techniques

- Domain Name System **(DNS) cache poisoning** - sends bogus records to a DNS resolver. When the victim requests an IP address, the DNS server will send the wrong IP address.

- **Address Resolution Protocol (ARP)** - spoofing transmits spoofed ARP messages out on the LAN. The spoofed messages falsely report a malicious actor's MAC address as being the victim's address.

- **MAC address spoofing** - will modify the MAC address on the malicious actor's NIC card so that it matches the MAC address on the victim's machine.

### PORTS

- Server Message Block (SMB) is TCP port 139. The tester can retrieve directory information, list, and transfer files. SMB is also over port 445 and is a common file and print service.

- Simple Mail Transfer Protocol (SMTP) is TCP port 25. The tester can extract email addresses, enumerate SMTP server information, and search for open relays.

- Domain Name System (DNS) is TCP port 53 for eliciting DNS zone transfers and discovering DNS subdomains.

- Hypertext Transfer Protocol (HTTP) is TCP port 80. They can manually request web pages, enumerate directories, files, WebDAV features, and versions.

### Types of Attacks

In a **side-channel attack**, this exploit is possible because of the shared nature of the cloud infrastructure, especially in a PaaS model.

In a **malware injection attack**, a malicious actor injects malicious code into an application. Common attacks can include SQL injection (SQLi) and Cross-Site Scripting (XSS).

In **direct-to-origin attacks (D2O)**, malicious actors circumvent proxy protections by identifying the origin network or IP address and then launching a direct attack.

**Domain Name System (DNS)** cache poisoning sends bogus records to a DNS resolver. When the victim requests an IP address, the DNS server will send the wrong IP address. 

## Lesson 10 - Testing Wireless Networks

- **PMKID** - **Wifite2** - is a wireless auditing tool you can use to assess the WLAN. Wifite2 can launch a variety of attacks including Pixie attacks, PMKID cracking, and more.

- **Airmon-ng** - will enable and disable monitor mode on a wireless interface. Airmon-ng can also switch an interface from managed mode to monitor mode.

- **Airodump-ng** provides the ability to capture 802.11 frames and then use the output to identify the Basic Service Set ID (MAC address) of the access point along with the MAC address of a victim client device.

- **Aireplay-ng** - injects frames to perform an attack to obtain the authentication credentials for an access point, which is usually performed using a deauthentication attack.

- **AWS** - **Pacu** is designed as an exploitation framework to assess the security configuration of an AWS account. It includes several modules to attempt exploits such as obtaining API keys or gaining control of a VM instance.

- One tool that can either spoof or clone a Bluetooth device is **Spooftooph**. Keep in mind, before making any changes to a Bluetooth adapter, you must run Spooftooph with root privileges.

- **ScoutSuite** -  is an open-source tool written in Python that can be used to audit instances and policies created on multi-cloud platforms, such as AWS, Microsoft Azure, and Google Cloud.

- **AWS Only** - **Prowler** is an audit tool for use with Amazon Web Services only. It can be used to evaluate cloud infrastructure against the Center for Internet Security (CIS) benchmarks for AWS.

<ins>How to Break into WPS Device</ins>:
- Physical push to connect feature
- Brute Force by PIN number

<ins>How to Attack WPA2 Enterprise network</ins>:
- **EAPHammer** is another Python-based toolkit with a wide range of features. It provides options that the team can use to launch an attack on a WPA2-Enterprise 802.11a or 802.11n network in an easy-to-use platform.

<ins>How to Attack WPA/WEP/WPS</ins>:
- **Fern** -  runs on a Linux OS and can recover WEP/ WPS/WPA/ keys using a variety of methods. Fern is a commercial product; there is a free version as well that offers limited functionality. 

<ins>Attacking Wi-Fi with MKD4</ins>
MDK4 is a powerful Linux based tool that features a wide range of attacks.

- **Mode b**- creates the appearance of many wireless networks. MDK4 is a powerful Linux based tool that features a wide range of attacks.

- In **Mode a** authentication, DoS will send multiple authentication frames to WAP in range with the intent of overwhelming the AP.

- In **Mode d** - it will send a deauth to disconnect and disassociate all clients from an AP. MDK4 supports 2.4 to 5GHz and has nine attack modules.

- **Mode w** - will provoke an Intrusion Detection and Prevention Systems confusion attack. When testing with this tool use caution, as some of the attack modules can have a serious negative effect on the network.

### Analyzing A Network Utilizing 802.1X
- FIRST ENTITY -**The Supplicant (or Wi-Fi client)** - is the first entity in 802.1X authentication. In a corporate WLAN, clients generally must authenticate prior to gaining access to the network using the 802.1X authentication protocol.

- SECOND ENTITY - **The Authenticator (or WAP)** is the second entity in 802.1X authentication. Once authenticated, a virtual port is created on the access point and the client can then access network resources.

- LAST ENTITY - **The Authentication Server (AS)** is the last entity in 802.1X authentication. It is generally a RADIUS server that provides the authentication.

## Lesson 11 - Taretting Mobile Devices

### Mobile Testing Framework

- **Mobile device assessment** -  A common element of the testing framework is mobile device assessment which provides an overview of compliance and business logic issues.

- **Secure app development** - A common element of the testing framework is secure app development which creates organization-specific apps that are in line with organizational policy.

- **Mobile app testing** - A common element of the testing framework is mobile app testing which includes Static Application Security Testing (SAST) and Dynamic Application Security Testing (DAST).

### Tools
- **Frida** - The forensics expert is using Frida which is an open-source tool that can work with a wide range of operating systems and allows the forensics expert to dump process memory, in-process fuzzing, and change a program's behavior.

- **APK Studio** - is an integrated development environment (IDE) designed so you can decompile and or edit an APK file.

- **Drozer** -  **Android** - is open-source software used for testing for vulnerabilities on Android devices. Drozer is an attack framework that allows you to find security flaws in the app and devices.

- **Objection** - **IOS** - is a runtime exploration toolkit that works on iOS devices. It is a scriptable debugger that allows digital forensic experts to perform various security-related tasks on unencrypted iOS applications.

### Device Policies

- **(COBO)** - **Corporate-owned, business only** - (COBO) means that the company will issue the employee a mobile device that the employee can only use for company business.

- **(BYOD)** - The company will allow the employee to bring their own device in the bring your own device (BYOD) deployment model.

- **(COPE)** - **Company and Personal Use** - The company will issue the employee a device that the employee can use for both company and personal business in the corporate-owned, personally enabled (COPE) deployment model.

- **(CYOD)** - **Choose Your Own Device** -The company will issue the employee a device that the employee can select from a curated list of devices in the choose your own device (CYOD) deployment model. 

### Attack Types

- **Bluejacking** - **Unwanted text messages** - The mobile user was the victim of a bluejacking attack which attackers use to send out unwanted text messages, images, or videos to a mobile phone, tablet, or laptop using a Bluetooth connection.

- **Rootkits** - provide a **backdoor for illegal access to a host**. Software developers often create backdoors to allow access for correcting code, but developers should remove them before the software is released.

- **Bluesnarfing** -  is an aggressive attack that allows a malicious actor to read information from a victim's Bluetooth device. The end goal is to glean sensitive data from the victim.

- **Worms** - are a virus sub-class that have the ability to spread without any help from a transport agent such as an email attachment.


### Device Threats

-**Patching fragmentation** - occurs when device owners do not implement updates in a timely manner. This fragmented approach can lead to individuals using unsupported versions that leave the system vulnerable.

-**Deperimeterization** - occurs when employees take sensitive data outside of the corporate perimeter and do not properly secure their devices. This risks data exfiltration.

-**Strained infrastructure** - occurs when the addition of multiple devices places a strain on the network and causes it to stop functioning at optimum capacity and may lead to an unintentional Denial of Service.

-**Forensics complications** -Dealing with bring your own device during a forensic exercise may cause forensics complications and prove difficult or even impossible and compromise the integrity of an investigation.

### Threat Assessments

- **MobSF** - **The Mobile Security Framework** (MobSF) can provide an automated evaluation of code and malware analysis using both static analysis and dynamic analysis.

- **MSTG** - **(Mobile Security Testing Guide)** provides an intuitive framework that steps you through the assessment process and includes a dashboard, security recommendations, and specifications for testing resiliency.

## Lesson 12 - Attacking Specialized Systems

### Attack Types

-**(MQTT)** - **unencrypted** - Message Queuing Telemetry Transport (MQTT) protocol which carries messages between devices, but the protocol does not encrypt the data which makes it vulnerable to attacks.



## Lesson 13/Section 12 - Web App Based Attacks

### Attack Tools

- **Gobuster** can discover subdomains, directories, and files by brute-forcing from a list of common names. This can provide information that was otherwise not available.

- **OWASP ZAP (Zed Attack Proxy)** is a proxy that allows for both automated and manual testing and identification of vulnerabilities.

- **DirBuster** is a web application brute-force finder for directories and files that comes with nine different lists, including default directories and common names given by developers.

- **w3af** (Web Application Attack and Audit Framework) allows users to identify and exploit a large set of web-based vulnerabilities, such as SQL injection and cross-site scripting.

- **TruffleHog** - The penetration tester is using truffleHog which can automatically crawl through a repository looking for accidental commits of secrets that will allow an attacker to modify code in a Git repository.

- **Brakeman** - is a static code analysis security tool for Ruby on Rails applications which checks for vulnerabilities and provides confidence level of finding (high, medium, weak).

- **SearchSploit** - is an exploit finder that allows users to search through the information found in Exploit-DB. It also supports Nmap outputs in XML format to search for exploits automatically.

- **BeEF (Browser Exploit Framework)** - focuses on web browser attacks by assessing the actual security posture of a target by using client-side attack vectors.

### Types of Attacks
- **Command injection attack** -
The threat actor executed a command injection attack in which the threat actor supplied malicious input to the web server, which then passed this input to a system shell for execution.

- **Code injection** is an attack that introduces malicious code into a vulnerable application to compromise the security of that application.

- **Data exfiltration** involves threat actors covering tracks by deleting entries from an access device or retrieving sensitive information through less conspicuous channels to avoid detection.

- **IoT** data corruption refers to faults in the information transmitted, stored, or otherwise managed by IoT devices.

### OWASP Top 10
- **Insecure data** transmission is on the OWASP Top 10 as A6:2017-Security Misconfiguration where data transmission must be secure, but implementations in security measurements may leave gaps.

- **Lack of error handling** - is on the OWASP Top 10 in A3:2017-Sensitive Data Exposure as an application may not respond gracefully to unexpected input which can lead to crashing the application.

- **Broken authentication** - is in the OWASP Top 10 as one the most relevant critical security risks to web applications and OWASP covers it in A2:2017-Broken Authentication.

- **Cross-site scripting (XSS)** - is in the OWASP Top 10 as one the most relevant critical security risks to web applications and OWASP covers it in A7:2017-Cross-Site Scripting (XSS).

### Trust Relationships
<ins>Trust between Server aand Resources</ins>

**In a server-side request forgery (SSRF)** attack, an attacker takes advantage of the trust established between the server and the resources it can access, including itself.

<ins>Trust between User and Webite</ins>

**In a cross-site request forgery (XSRF/CSRF)** attack, an attacker takes advantage of the trust established between an authorized user of a website and the website itself.

<ins>Other Attacks</ins>

**Session hijacking** is the process of stealing the session credential from a user's browser and then using it to impersonate the user on a website.


**Privilege escalation** (or simply PrivEsc) describes obtaining a higher privilege than the one the user currently has, to enable resources that the regular user does not have permission for. 

**Session fixation attack** -(SID) which requires the user to authenticate with a known session identifier that the threat actor will then use for impersonation.

**Session replay** - requires having access to the user authentication process itself so that the threat actor can intercept it and repeat it.

**Business logic flaw** - which is a vulnerability that arises from implementation and design issues that lead to unintended behavior.

**Horizontal privilege escalation** is obtaining access to a regular user account with different access or permissions than the one currently in use.

**Vertical privilege escalation** is to obtain access to an account of higher privilege than the one we currently have, to enable resources that the regular user does not have permission for.

### Cross Site Scripting Attack Types
- **(DOM)-based attack** In a Document Object Model (DOM)-based attack, the threat actor does not send malicious scripts to the server, instead, they take advantage of a web app's client-side implementation of JavaScript to execute the attack solely on the client.

- **Persistent attack**, also called a stored attack, you inject malicious code or links into a website's forums, databases, or other data.

- **Reflected attack**, a threat actor crafts a form or other request that the system will send to a legitimate web server. This request includes the malicious script.

## Lesson 14/Section 17 - System Hacking

- **Secure Shell (SSH)** is the modern answer to Telnet's lack of encryption and other security mechanisms. Some systems have SSH enabled by default.

- **rlogin** is a Linux command that is similar to Telnet, but if the server has an .rhosts file configured a certain way, a user won't need to supply credentials.

- **Netcat** is a command-line utility used to read from or write to TCP, UDP, or Unix domain socket network connections. It is highly versatile but does not use encryption.

- **Ncat** is a tool developed for Nmap as an improvement over Netcat, not only retaining most of the functionality but also adding more of which is support for SSL.

### Commands

- **NO DNS Lookup** - (**-n option**)- The penetration tester can use the -n option to tell Netcat not to perform DNS lookups for host names on the other end of the connection.

- **Specify Port** (**-p option**) -Penetration testers can use the -p option to specify the port that Netcat should start listening on in listen mode. In client mode, it specifies the source port.

- **No packet payload** - **(-z option)** Penetration testers can use the -z option to start Netcat in zero I/O mode, which instructs it to send a packet without a payload.

- **ListenMode** - **(-l option)** Penetration testers can use the -l option to start Netcat in listen mode. The default mode is to act as a client.

### Tools

- **rsh** - is a Linux command that can open a shell, and if the server has an .rhosts file configured a certain way, the penetration tester won't even need to supply credentials.

### Frameworks

<ins>General Framweorks</ins>
- **C2** - The command and control (C2) frameworks manage available exploits, as well as help penetration testers keep control of the devices the tester has targeted.

- **Web Browser Attacks** - **The Browser Exploit Framework (or simply BeEF)** - focuses on web browser attacks, which means exploiting some functionality or vulnerability on the browser.

<ins>Mac Framworks</ins>

**Mythic** is a cross-platform C2 framework tool that works with macOS, Linux, and Windows, but it contains payloads that provide consistently good results when PenTesting macOS.

<ins>Windows Frameworks</ins>

**Empire** is a C2 framework that makes use of **PowerShell** for common post-exploitation tasks on Windows. It also has a Python component for Linux.

**Covenant** is a .NET command and control framework and, in a similar fashion to Empire, it aims to show the attack surface of .NET and make attacks through this vector easier.

**Nishang** is a specific **PowerShell** tool that includes a large set of scripts for Windows post-exploitation.

**Note-** .NET works on Windows, Linux, and Mac. 

### Machine Code
- **Disassembly**-  is the reverse engineering process of translating low-level machine code into higher level assembly language code that is human readable and can include familiar programming elements.

- **Decompilation** -  is the reverse engineering process of translating an executable into high-level source code to help determine whether the application's logic will produce unintended results.

- **Debugging** -  is the process of manipulating a program's running state in order to analyze it for general bugs, vulnerabilities, and other issues.

- **Static code analysis** - is the process of reviewing uncompiled source code either manually or using automated tools to correct errors.

### Powershell Commands
```-nop option``` - Tells PowerShell not to load any particular profile, which may customize the way PowerShell behaves in the environment.

``` -p option``` - When a PenTester uses the -p option it specifies the payload, for instance, the PenTester can use the -p option to select reverse_powershell which is located inside cmd/windows."

```-w hidden option``` - Specifies that when the payload executes, the script will hide the PowerShell window.

```-c option``` - when executing PowerShell to specify that PowerShell will execute the following command block or script and then exit. 

## Lesson 15 - Section 21

### Scripting Tools

### Variables

- **Boolean** - can be true or false
- **Pseudocaode** - generalized form for discussing languages
- **Integer** - a variable that stores a number
- **Float/Decimal/Real Number** - A variable that stores a decimal number
- **Character** - Only stores 1 ASCII character
- **String** - A variable that contains multiple characters

### 

## Lesson 15 - Sections 22 Part 1

## Lesson 15 - Section 22 Part 2


## Lesson 16 - Section 17

**How to Initiate Persistence**: 

- An **Advanced Persistent Threat (APT)** is a type of threat in which an unauthorized user gains access to a system or network and remains undetected for an extended period. During this time, they typically exfiltrate data or perform other malicious activities.
 
- A **backdoor** is a hidden mechanism that provides unauthorized access to a system. While it might be a component of an attack, it's not a description of a long-term, data-exfiltrating threat.

- **Reverse shells** provide remote access, and they require additional measures to become persistent. Embedding the shell in startup scripts, registry entries, or other autostart locations ensures the connection is re-established after the system reboots or disruptions, providing persistent access.
 
- A **bind shell** is a type of **reverse shell** where the target system "binds" its shell to a local network port for remote access. This doesn't necessarily imply a long-term, data-exfiltrating threat.
 
- A **daemon** refers to a background process or service on a system. It doesn't describe the situation which is associated with a long-term, data-exfiltrating threat.

**How to Gather Passwords**:

- The PenTester is using **mimikatz** which gathers credentials by extracting key elements from memory such as cleartext passwords, hashes, and PIN codes.

- **Hashcat** is a password and hash cracking tool that uses different attack methods (dictionary, mask, hybrid) to add complexity and variability.

- **Brutespray** interprets results from an Nmap scan to automatically start medusa against the identified open ports and can also use results from nmap with option -sV to identify and target services on non-standard ports.

- **CeWL** generates word lists based on automatically navigating a website and collecting words from text as well as author/creator metadata from files that the tool finds.

**Password Cracking**

- The PenTester is using a **rule attack** which can make use of word lists to create variants and combinations and can then try trimming or expanding words or substituting numbers or special characters for letters.

- **Password spraying** is the concept of controlled brute-forcing by testing several accounts with common or targeted passwords.

- In a **mask attack** the cracking tool can try specific combinations of characters using placeholders (i.e., ?a?a?d?d?d?d).

- A **dictionary** attack is the most straightforward type of automated password attack. A password cracking tool goes through a list of words until it either finds the password or exhausts the list.

## Lesson 17 - Section 18 - Communications and Reports

### Logical Vulnerabilities

**NON-OSI vulnerabilities** are a type of logical vulnerability that a PenTester may identify when creating a report based on the Penetration Testing Execution Standard (PTES).

The **vulnerability type** - is a logical vulnerability. When creating a report based on the Penetration Testing Execution Standard (PTES), a PenTester would include the type of vulnerability.

### Technical Vulnerability

-**OSI Layer vulnerabilities** are a type of technical vulnerability that a PenTester may identify when creating a report based on the Penetration Testing Execution Standard (PTES).

-**Manually identified vulnerabilities** are a type of technical vulnerability that a PenTester may include in a report based on the Penetration Testing Execution Standard (PTES).

-**The location of vulnerabilities** is a type of logical vulnerability, not a technical vulnerability.

### Policy Based Consideration

-**Password Complexity Requirements** - is a policy-based consideration, not a technical vulnerability. While it can affect the security posture of a system, it is not categorized as a technical vulnerability in the context of the Penetration Testing Execution Standard (PTES).

### Engagement Types

-**De-escalate** to mitigate this issue. The team would work together to scale back on their efforts to de-escalate the effects of the test.

-**Consult with legal counsel** - **discovered criminal conduct** -  in cases where the PenTesting team uncovered criminal conduct, in which case the law might require them to notify law enforcement.

-**Deconflicting** is the process of **providing situational awareness** to key client personnel to resolve issues in order to resume the penetration test.

-**Goal reprioritization** - is the catalyst for possible adjustments to the engagement. The need for contingency planning for the PenTest engagement itself enables the reprioritization of goals.

### Contact Types

-**primary contact** is the party responsible for handling the project on the client's end and is responsible for the major decisions surrounding the penetration test.

-**technical contact** is the party responsible for handling the technology elements of the activity as they have a more in-depth knowledge of the technical aspects of the system.

-**emergency contact** is the party that the PenTesters will contact in case of particularly urgent matters and should be available 24/7 or at least during the hours of active testing.

-**IT manager** -  is typically the person the designated lead of the PenTesting team should have close communication with and the two lead roles must both be hands-on.

### False Positives

The PenTesting team can **validate results** by comparing what they've learned about the target environment to individual scan results to identify whether or not the results are truly applicable and accurate.

The PenTesting team can **rely on their knowledge of the system** and understanding of the target environment if that knowledge is complete.

**Note**
- The PenTesting team cannot ignore common false positives because they may be relevant positives depending on the environment tested.

- The PenTesting team should not **research every result** but must be able to identify when results indicate a false lead on a vulnerability to avoid wasting time chasing a lead that takes them to a dead end.



