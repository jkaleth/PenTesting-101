# PenTest + Exam Prep
## Lesson 1 - Scoping Organization/Customer Requirements

- To learn more about the vulnerabilities, you can often click on CVE names, which have hyperlinks to the record in the **National Vulnerability Database (NVD)**. Once there, you can read more details.

- As vulnerabilities are identified, they are first rated as to the severity using the Common **Vulnerability Scoring System (CVSS).** The score is derived using a set of metrics, which helps in prioritizing vulnerabilities.

- The information from the CVSS is fed into the **Common Vulnerabilities and Exposures (CVE).** The CVE is a listing of all publicly disclosed vulnerabilities.

- **The ISSAF** contains a list of 14 documents that relate to PenTesting, such as guidelines on business continuity and disaster recovery along with legal and regulatory compliance

**The Penetration Testing Execution Standard (PTES)** has seven main sections that provide a comprehensive overview of the proper structure of a complete PenTest. Some of the sections include details on topics such as pre-engagement interactions, threat modeling, vulnerability analysis, exploitation, and reporting.

The **Open Web Application Security Project (OWASP)** is an organization aimed at increasing awareness of web security and provides a framework for testing during each phase of the software development process.

**OSSTMM** provides a holistic structured approach to PenTesting. Written in 2000, the open-source document stresses auditing, validation, and verification.

Computerized electronic patient records are referred to as **electronic protected health information (e-PHI).** With HIPAA, the **e-PHI** of any patient must be protected from exposure, or the organization can face a hefty fine.

**The Health Insurance Portability and Accountability Act (HIPAA)** is a law that mandates rigorous requirements for anyone that deals with patient information.

**The California Consumer Privacy Act (CCPA)** was enacted in 2020 and outlines specific guidelines on how to appropriately handle consumer data.

In 2018 the EU enacted the **General Data Protection Regulation (GDPR)**, which outlines specific requirements on how consumer data is protected. 

*NIST* has many resources for cybersecurity professionals that include the Special Publication (SP) 800 series, which deals with cybersecurity policies, procedures, and guidelines.

## Lesson 3- Footprinting & Gathering Intelligence
**Service (SRV)** record provides host and port information on services such as voice over IP (VoIP) and instant messaging (IM).

**Text (TXT)** record provides information about a resource such as a server or network in human readable form.

**Nameserver (NS)** record lists the authoritative DNS server for a particular domain. A standard DNS query will use DNS servers to identify the Internet Protocol (IP) address behind a particular domain or resource name.

**Mail Exchange (MX)** record provides the mail server that accepts email messages for a particular domain.

## Question
**Question-**
A security analyst is trying to find older versions of a company's website which contained sensitive information. They are worried that attackers might still be able to find older versions, so they want to try using web search commands. Which web search command would help them search?

Use a standard **cache** search on a site, and you will see a recent view of the website. To do a quick check simply type cache: in the address bar. For example, cache:https://comptia.org.

**inanchor** searches anchor text. For example, use inanchor:Certification report to search for any pages whose anchor text includes the text "Certification" and have the text "report" anywhere on the page.

One would use **inurl:Certification report** to search for any pages whose URLs include the text "Certification" and have the text "report" anywhere on the page.

The security professional would enter the **site:comptia.org** report to search CompTIA's website only for results including the text "report."

***Question-***
A security researcher wants to scan documents against a website for only pdf documents. What metagoofil parameter could they use?

**metagoofil -t** pdf scans for pdf documents. Metagoofil scrapes the metadata, and then displays the information using Hypertext Markup Language (HTML).

**metagoofil -d** comptia.org scans for documents on Comptia.org. Metagoofil uses various python libraries such as PdfMiner, GoogleSearch, and Hachoir.

**metagoofil -l 75** searches for 75 documents. The output can then be viewed in a standard browser. Another valuable tool is FOCA, which can discover metadata from a variety of sources.

**metagoofil -n 25** downloads 25 files. You can download a copy of Metagoofil from GitHub. In addition, the tool is built into Kali Linux. 

***Question-***
The **Certification Revocation List (CRL)** is a list of certificates that in some way have been deemed invalid. Although effective, most online services have moved to the newer OCSP to check the validity of the certificate.

**Network Connections (ncpa.cpl)** is a Control Panel applet for managing adapter devices, including IP address information.

A more useful field in a digital certificate from a reconnaissance perspective is the **subject alternative name (SAN). SANs** can identify specific subdomains that can be covered by the certificate.

**The Social Engineering Toolkit (SET)** is a Python-based collection of tools that can be used when conducting a social engineering PenTest.

The **robots.txt** file is the most common and effective way to prevent search engine crawlers from indexing or accessing specific pages or directories. A robots.txt file can be easily created and updated as needed, and it is a standard method that is recognized by most bots and crawlers.
 
An **ACL** could be effective in restricting access to specific directories, but it may not be as easy to implement as using a robots.txt file.
 
**Blocking specific user agents** could work to prevent specific bots or crawlers from accessing the site, but it may not be as flexible or scalable as using a robots.txt file.
 
**Creating a noindex meta tag**on each page to be excluded would not prevent other types of bots or crawlers from accessing specific pages.

**theHarvester** is an intuitive tool that can search a company's visible threat landscape. The tool gathers information on subdomain names, employee names, email addresses, PGP key entries, and open ports and service banners.

**Shodan** is a search engine designed to locate and index IoT devices that are connected to the Internet.

**Dirbuster** is specifically geared towards website enumeration. There are numerous tools and techniques available to evaluate a website.

**Metagoofil** uses various python libraries such as PdfMiner, GoogleSearch, and Hachoir to scrape the metadata, and then displays the information using Hypertext Markup Language (HTML). 

## Lesson 4- Evaulating Human and Physical Vulnerabilities

**intitle:"DPH" "web login setting"** i would be used to find information of D -Link Phones. If they don't have the password, they can search online for the default password to try on the targeted system.

**iinurl:"ccmuser/logon.asp"** i would be used to find Cisco CallManager instances. They can also try some other Google Hacking to find more information on VoIP phones that you can use to launch the attack.

**iintitle:"Grandstream Device Configuration"** i password would be used to find information about Grandstream phones.

**iinurl:"CallManager"** i  would not be a valid instance of attempting to find CallManager instances, they would have to search for ccmuser.

## Lesson 5 - Preparing the Vulnerability Scan

**Nikto** is an open-source web server scanner that can complete comprehensive testing on web servers for a variety of vulnerabilities, such as anticlickjacking X-Frame-options header, and dangerous files and CGIs.

A team can run a vulnerability scan using the **Open Vulnerability Assessment Scanner. OpenVAS** will list the vulnerabilities along with a risk rating that summarizes the overall state of the site that was tested.

**SQLmap** is an open-source database scanner that searches for and exploits SQL injection flaws.

When testing for vulnerabilities, one tool the team can use is **Censys**, an attack surface analyzer, similar to Shodan, to identify exposed systems. 

**Hping3** is also a tool to craft and send a malformed packet to your target. For example, the Christmas (XMAS) scan might be able to bypass security mechanisms that follow strict interpretation of RFC 793.

## Lesson 16

**How to Initiate Persistence**: 

- An **Advanced Persistent Threat (APT)** is a type of threat in which an unauthorized user gains access to a system or network and remains undetected for an extended period. During this time, they typically exfiltrate data or perform other malicious activities.
 
- A **backdoor** is a hidden mechanism that provides unauthorized access to a system. While it might be a component of an attack, it's not a description of a long-term, data-exfiltrating threat.

- **Reverse shells** provide remote access, and they require additional measures to become persistent. Embedding the shell in startup scripts, registry entries, or other autostart locations ensures the connection is re-established after the system reboots or disruptions, providing persistent access.
 
- A **bind shell** is a type of **reverse shell** where the target system "binds" its shell to a local network port for remote access. This doesn't necessarily imply a long-term, data-exfiltrating threat.
 
- A **daemon** refers to a background process or service on a system. It doesn't describe the situation which is associated with a long-term, data-exfiltrating threat.

**How to Gather Passwords**:

- The PenTester is using **mimikatz** which gathers credentials by extracting key elements from memory such as cleartext passwords, hashes, and PIN codes.

- **Hashcat** is a password and hash cracking tool that uses different attack methods (dictionary, mask, hybrid) to add complexity and variability.

- **Brutespray** interprets results from an Nmap scan to automatically start medusa against the identified open ports and can also use results from nmap with option -sV to identify and target services on non-standard ports.

- **CeWL** generates word lists based on automatically navigating a website and collecting words from text as well as author/creator metadata from files that the tool finds.

**Password Cracking**

- The PenTester is using a **rule attack** which can make use of word lists to create variants and combinations and can then try trimming or expanding words or substituting numbers or special characters for letters.

- **Password spraying** is the concept of controlled brute-forcing by testing several accounts with common or targeted passwords.

- In a **mask attack** the cracking tool can try specific combinations of characters using placeholders (i.e., ?a?a?d?d?d?d).

- A **dictionary** attack is the most straightforward type of automated password attack. A password cracking tool goes through a list of words until it either finds the password or exhausts the list.
