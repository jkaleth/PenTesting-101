# Vulnerability Scanning

## Vulnerability Lifecycle
**Vuln Lifecycle**
1. **Discover-** Identify Vulnerability by scanning. Create Exploit
2. **Coordinate** - Report Vulnerablility. Generate CVE
3. **Mitigate** - Release CVE, release patch
4. **Manage** - Deploy patch and test systems
5. **Document** - Record results and lessons leanred

Zero Days

## Vulnerability Scans

<ins>**NMAP**

```
Sends Probes: -sn 

$ nmap -sn -v 192.168.1.0/24 on a LAN, to scan for live hosts.

The option -sn was known as -sP in earlier versions of Nmap.

```
Because firewalls may block standard probes used during the ping sweep, several applications have other choices to attempt to determine if a host is online. Choices include using the following:

- TCP SYN Ping
- TCP ACK Ping
- UDP Ping
- IP Protocol Ping
- ARP Scan

Scanning Ports

By default, when completing a ping sweep using Nmap, the application will complete the following:

    Scan the network for live hosts
    Run a port scan on any live hosts.

However, if the analyst uses -sn, this option will simply print available hosts.

Once the team has identified live hosts, the next step is to run a port scan to see if any live hosts have ports that are open and listening.

Port scanning is the process of determining which TCP and UDP ports are listening on the target. It is the first step in determining what services are running on the target.

<ins>The following lists some common ports and their services:
    
    - Port 25 Simple Mail Transport Protocol (SMTP)
    - Port 53 Domain Name System (DNS)
    - Port 80 Hypertext Transfer Protocol (HTTP)
    - Port 88 Kerberos
    - Port 110 Post Office Protocol version 3 (POP3)

A port scan will generally scan the well-known ports (1-1023); however, the app can be set to scan a larger range.

### Stealth Scans

<ins> Stealth scans include the following:

- <ins>**TCP SYN (or half-open)**</ins> - scan is the original stealth scan. The scan sends a packet to the target with the SYN flag set. This is called a "half-open" scan because the attacker does not complete the TCP three-way handshake

        - If the port is open, the target will return a SYN ACK.
        - If the port is closed, the target will return a reset (RST).
        - If the target is filtered using a firewall, the packet will be dropped and no response is sent.

- <ins>**FIN scan**</ins> - sends a packet to the target with only the FIN flag set.

- <ins>**NULL scan**</ins> - is a packet sent without any flags set.
    
- <ins>**XMAS Tree scan**</ins>-  sends a packet with the FIN, URG, and PSH flags set and appears to be “lit up like a Christmas Tree.”

## Scanning Considerations
<ins>**Automating Scanning**

When the PenTest team plans the assessment, they will most likely scan from the outside looking in to the web server, which is similar to what would be seen by a malicious actor.

Application vulnerability testing methods are commonly grouped into two main categories:

-**Static Application Security Testing (SAST)** is done early in the software development life cycle to examine the code for security vulnerabilities.

-**Dynamic Application Security Testing (DAST)** is done after the code is placed in production. Unlike SAST, dynamic testing will unearth vulnerabilities that are evident after the code is in production.

<ins>**Types of Scans**:</ins>

- <ins>**Mandatory Requirements**</ins> - **The Security Content Automation Protocol (SCAP)** is a US standard used to ensure applications are in line with mandated security requirements.

- <ins>**Found After Entering Production**</ins>- **Dynamic Application Security Testing (DAST)** is done after the code is placed in production. Unlike SAST, dynamic testing will unearth vulnerabilities that are evident after the code is in production.

- <ins>**Done early in Dev Cycle</ins>**- **Static Application Security Testing (SAST)** is done early in the software development life cycle to examine the code for security vulnerabilities.

- <ins>**OPENVAS</ins>** -  A team can run a vulnerability scan using the Open Vulnerability Assessment Scanner. OpenVAS will list the vulnerabilities along with a risk rating that summarizes the overall state of the site that was tested.


### <ins>Sniffing Using Wireshark

**Packet sniffing** is used to examine network traffic to better understand the characteristics and structure of the traffic flow. Sniffing traffic is a straightforward way for the PenTest team to passively obtain information about the network, and can be used to identify the following:

- Network hosts, 
- Services, 
- Device types
- Protocols, 
- Subnets
- IP,
- MAC addresses

Sniffing can take advantage of cleartext protocols and data traveling across the network. The analyst can learn a great deal about the network by monitoring protocols such as: TCP, ARP, SMTP, HTTP, and others. If the traffic is in cleartext, you can capture credentials, files, images, messages, and data meant for other users and machines.

Sniffers such as Wireshark have the ability to recreate entire TCP sessions. However, even if the payload is encrypted, you can still extrapolate vital information that includes:

- Source and destination address and ports
- WLAN SSIDs and accompanying cleartext messages.
- Handshakes and outside wrapper IP addresses of VPN traffic

To effectively use packet analysis, the team will need to select an appropriate location to visualize the traffic. Keep in mind, depending on the placement, you may only be able to capture a portion of the total network traffic.

To effectively monitor network traffic there are a couple of guidelines:

    - The sniffer's interface must be in promiscuous mode to gather all traffic.

    - If the team is testing a WLAN, the sniffer must be within radio range.

<ins>**ARP poisoning**</ins>

Layer 2 Attack to condect MitM attacks. 

For example, the team might use MAC addresses to launch an ARP poisoning attack. This attack deliberately maps an incorrect MAC address to a correct IP address, which poisons the ARP cache. ARP poisoning is used to redirect traffic for malicious purposes. This technique is one of the most common spoofing mechanisms used on Ethernet and Wi-Fi networks, as it allows an attacker to insert themselves in a man-in-the-middle attack between two legitimate hosts.

To gather ARP traffic, the team can use the following:

-  **Nessus**, which has several plugins to enumerate MAC addresses on targets

- **Nmap** can also gather MAC addresses by using the following command : nmap -PR -sn <target> . In this command, -PR will do an ARP ping and -sn will disable a port scan.

- **Arping** is a tool found in Kali Linux. Arping will send a series of ARP requests to the target. The target will send an ARP reply in response.

When using Arping, you will need to use Wireshark and use arp as the display filter to see the response.

### Scanning Logical Vulnerabilites
<ins> Wireless:

- **(dBi)** - The signal strength of a wireless antenna is referred to as decibels per isotropic (dBi) and can vary according to the design.

- **(SNR)** The goal is to have a good Signal-to-Noise Ratio (SNR), which is the measurement of a wireless signal level in relation to any background noise.




## Nessus Scanning

## OpenVas Scanning
 
 ## Nikto Scanning
