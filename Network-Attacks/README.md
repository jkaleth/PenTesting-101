# Network Attacks

**Presentation- 
Datalink - mac addresses
Network- ip address
Transport
Session
P
Application

## Stress Testing
How to conduct- Use scripts with pythin or powershell or use Grinder. 

- Broadcast Storm- use any random data sequence. 
- Character Generator Protocol- used for testing the network over port 19

## Exploit Resources
- **Exploit Databse**- collection of public exploits. 
[Exploit Database](https://exploit-db.com/)
- **Packet Storm Security**- links back to CVE advisories. [Packet Storm](https://packetstormsecurity.com/). You could use CVE's to look up tools to use to exploit a system.
- **Explot Chaining-** Combining exploits together. 

## ARP Poisoning (Adress Resolution Protocol)
-this utilizes mac address to keep track of devices. 
- Configure static ARP table to arp spoof. 
- Create binding of mac address and ip address using layer 2 of the OSI model
- How to ARP spoof
    1. Identify ip and mac address with NMAP
    $ nmap -pr -SN target ip
    2. Use a spoofing tool like arpspoof or metasploit

## DNS Cache Poisoning
Changethe ip address of a domain name stored in the DNS Cache. 

How to check for DNS recursion- 
```
$ nmap -sU -p53 --script=dns-recursion <IP>
```
If recursion is enabled you could try to perform a dynamic DNS update without authentication 

```
$ nmap -sU -p53 --script=dns-udpate --script-args=dns-update.hostname=<domain>,dns-update.ip=<IP> <target>
```

How?
- Poison server or workstation DNS cache
- Highjacking local DNS server
- Performing unauthorized domain transfer to an unpatched DNS server where you could change the IP address of a given servers A record. 

## DNS Sec
DNS Security extensions- Uses encrypted digital signatures.

There's a public and private key pair for every DNS zone. 

To do a zone transfer on Mac. 
```
$ dig afxr ns.domain.com ns.attacker.com
```

## LLMNR 
The following are good for creating Bluetooh, wifi and other networks

**For WINDOWS only**

LLMNR stands for Link-Local Multicast Name Resolution. It's a protocol used in modern Windows operating systems as a method of resolving the IP addresses of neighboring network devices when the Domain Name System (DNS) resolution fails. LLMNR operates similarly to the more commonly known DNS protocol but is specifically designed for local networks or subnets, especially in cases where no DNS server is available or DNS queries fail.

LLMNR functions by broadcasting a query on the local subnet to resolve a domain name into an IP address. If a device with the requested name exists on the same subnet, it can respond to the LLMNR query, providing its IP address. This protocol assists in name resolution between devices on the same local network segment without the need for a configured DNS server.

**For Linux** 

The following are good for creating Bluetooh, wifi and other networks

**Zeroconf** short for Zero Configuration Networking, is a set of networking protocols that allows devices to automatically discover each other and communicate on a local network without requiring manual configuration or the presence of a centralized server or Domain Name System (DNS).

Zeroconf includes several key technologies:

**Address Allocation:** It enables devices to assign IP addresses to themselves automatically without needing a DHCP (Dynamic Host Configuration Protocol) server.

**Service Discovery:** Devices on the network can advertise and discover services such as printers, file-sharing resources, or other devices without the need for a dedicated server.

**Name Resolution:** It allows devices to resolve each other's hostnames without relying on a DNS server by using multicast DNS (mDNS).

**Link-Local Addressing:** Devices can communicate using link-local addresses, which are automatically assigned and allow communication between devices on the same local network segment.

Zeroconf simplifies network setup and facilitates communication between devices, particularly in situations where manual configuration is impractical or not feasible, such as in small home networks, peer-to-peer networks, or in situations where there's a need for immediate connectivity without complex configuration steps. Technologies like Apple's Bonjour, Microsoft's Universal Plug and Play (UPnP), and the IETF's protocols such as mDNS and DNS Service Discovery (DNS-SD) are all implementations of Zeroconf principles.

## Net-Bios Name service
Uses the host name of a system for resolution. 

How to attack the above:

**Responder**

Responder is a powerful tool used in cybersecurity and penetration testing, primarily within the realm of ethical hacking. It's included in Kali Linux, a popular operating system for penetration testing, digital forensics, and security auditing.

Responder is specifically designed to gather and capture credentials passed over the network. It works by listening to network traffic and responding to certain requests, attempting to trick devices on the network into disclosing sensitive information such as usernames and hashed passwords.

This tool takes advantage of certain weaknesses in protocols like LLMNR (Link-Local Multicast Name Resolution), NBT-NS (NetBIOS Name Service), and mDNS (Multicast DNS), which are used in Windows environments for hostname resolution and network discovery. Responder can imitate legitimate services and capture authentication data from devices attempting to connect or resolve hostnames.

MAC Spoofing
Hiding a MAC address. Identify addresses on same network. 

Layer 2 devices use MAC addresses to associate which device is connected to which physical port. 

MAC Filtering- Create an allow or block list for which devices can or cannot connect to a network. 

MAC spoofing is a technique used to modify or forge the Media Access Control (MAC) address of a network interface. Every device that connects to a network has a unique MAC address assigned to its network interface card (NIC). MAC addresses are used for communication within a local network.

MAC spoofing involves changing the MAC address of a network device to impersonate another device or to mask the identity of the original device. This can be done for various reasons, such as:

**Privacy:** Users might change their MAC address to prevent tracking or profiling by network administrators, advertisers, or other entities interested in monitoring their online activities.

**Security Testing:** Ethical hackers or security professionals might use MAC spoofing as part of penetration testing or security assessments to evaluate network security measures.

**Bypassing Access Controls** MAC spoofing can be used to bypass access controls that rely on MAC addresses for authentication or authorization purposes. By impersonating an authorized device, an attacker might gain unauthorized access to a network.

Change MAC on a Mac or linux
```
$ sudo ifconfig en0 ether <MAC address>
```

If you reboot it resets it back to default though.

macchanger can also do this in Kali Linux

```
$ macchanger -m MAC network interface
$ macchanger -r MAC network interface- random mac
```

## VLAN Hopping
VLAN's are used to partition a broadcast domain and isolate it from the rest of the network. 

**Double Tagging** attacker tries to reaach a different VLAN using the vulnerabilities in the trunk port configuration. 

VLAN hopping is a network security exploit that occurs when an attacker gains unauthorized access to traffic in different Virtual Local Area Networks (VLANs) that are typically isolated from each other. VLAN hopping exploits weaknesses or misconfigurations in network devices, such as switches, to gain access to traffic on VLANs other than the one to which the attacker's device is supposed to belong.

There are primarily two types of VLAN hopping:

    Double Tagging (IEEE 802.1Q): This type of VLAN hopping occurs when an attacker inserts two VLAN tags (802.1Q tags) into Ethernet frames. By doing so, the attacker can make the frame appear as though it belongs to multiple VLANs. The attacker's device adds an additional VLAN tag (802.1Q) to the frames it sends, allowing it to potentially access and receive traffic from another VLAN.
        - Inner Tag- True destination set by the attacker
        - Outer tag- Native VLAN

    Switch Spoofing (Dynamic Trunking Protocol - DTP): Some switches utilize a protocol called Dynamic Trunking Protocol (DTP) to negotiate whether a port should operate as an access port or a trunk port. In switch spoofing, attackers send forged messages to the switch pretending to be another switch, thereby tricking it into changing a port's mode from access to trunk. This enables the attacker to send traffic tagged with any VLAN ID, potentially gaining access to multiple VLANs.

To prevent VLAN hopping attacks, it's crucial to implement best security practices, such as:

- Disabling unnecessary trunking protocols like DTP and manually setting ports as access or trunk ports.

- Implementing proper VLAN segregation and access control lists (ACLs) to restrict VLAN access.

- Regularly updating and patching network devices to fix known vulnerabilities related to VLAN hopping.

- Using network monitoring tools to detect and mitigate unusual or unauthorized network activity.

- Always configure switch ports to have dynamic switch port modes disabled by default. 

## NAC Bypass
