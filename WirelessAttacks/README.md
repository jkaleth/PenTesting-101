# Wireless Attacks

## Wireless Security
  - WEB (802.11) original standard - Wired equivalent privacy
  - WPA (Wi-fi protected Access) uses TKIP
  - WPA2- uses ccmp, (802.11i) AES 128 bit encryption
  - WPA3 - Personal - 128bit- AES  CCMP
  - WPA3 - Enterprise - 256bit - AES with SHA -384 
    - SAE Simultaneous Authentication of Equals - password based authentication
    - Forward Secrecy 
      - Step 1- pair of long term keys is created
      - Step 2- one-time use session key is exchanged
      - Step 3- AP send client messages and encrypts them  using the created session key
      - Step 4- Client decrypts messgae using the same one-time use session key
      - Step 5- Process repeats for each message sent starting at step 2
  - WPS Wi-Fi protected setup- 8 digit pin code. it breaks it up into 4 digits chunks which are very easy to crack. So it should ALWAYS be disabled
  
**Exam Quick tips**
- Open  - No security or encryption used
- WEP - Identify weakness as an initialization vector (IV)
- WPA- RC4 and TKIP are exploitable
- WPA2- AES and CCMP are exploitable
- WPA3- Dragonfly 

** MAC Filtering
Change mac adress with macchanger -a

## Bypassing MAC Filtering
know devices kwown so you can connect. 
Change MAC address to their MAC address using macchanger to get assinged new random mac address- this masks who you are. 

to spoof- change one to mimic user

## Signal Exploitation

- Eavesdropping
  - Promiscuous Mode- put adapter into this mode- all network packets can be viewed by all network adapters. Allows sfiffing to happen
- Deauthentication- boot a wireless client off an access point to it's forced to reauthenticate. - typically used with other attacks. 
- Jamming- disrupts a wi-fi signal by broadcasting on the same frequency as the target access point to block signals that a wireless transciever attempts to send or receive. 


## WEP Hacking - very insecure
- 24bit IV only 
- Airomon-NG - used to monitor wirless frequencies to identify access points and clients. 
- Airodump-NG - capture network traffic and send to PCAP
- Airocrack- brute force password cracking 

## WPA/WPA2 Hacking
- Put wireless adapter in promiscuous mode with Airomon-NG
- Discover WPA networks using Airodump-NG
- Capture the network traffic and write to PCAP file
- Conduct a deauthentication attack to generate handshakes to capture 
- Conduct a dictionary attack to identify the plain text version of the preshared key

## WPS PIN Attacks
Use wash
Use reaver

## Evil Twins
A fake wifi access point that appears to be legit but is setup to eavesdrop. 

**Karma Attack-** exploits the behavior of Wi-Fi devices due to a lack of access point authentication protocols being implemented. 

**Preferred Network List-** List of previously used SSID's and will automatically connect when in range. 

To execute the karma attack you simply listen for the PNL broadcasts. 

**Captive Portal -** a web page that a user of a public wifi network interacts with before access is granted. Might as for google or facebook credentials to access a wireless network

How to run a Evil Twin attacks- 
- Setup portal like ESPortalV2
- Wifiphisher in Kali linux- does not use a porta 
- WiFi Pineapple- self contained hardware device running imbedded linux with all tools needed for wireless network engagements. 

## On-Path and Relay Attacks
Formerly referred to as a man-int-themniddle attack .

An On-Path attack refers to a type of cyber attack where a malicious actor gains access to the network path between two communicating parties (such as a client and a server) and intercepts, modifies, or blocks the communication flowing between them. The attacker positions themselves strategically within the network infrastructure to eavesdrop on the data packets being transmitted.

This type of attack allows the attacker to monitor, manipulate, or disrupt the communication without necessarily having control over the endpoints involved. On-Path attacks can be used for various purposes, including:

**Eavesdropping:** Intercepting data to gather sensitive information like login credentials, financial details, or personal information.

**Data Modification:** Altering the information being transmitted between the communicating parties. For instance, changing the recipient's account number in a financial transaction.

**Denial of Service (DoS):** Blocking or disrupting the flow of communication, making a service unavailable to legitimate users.

Examples of On-Path attacks include Man-in-the-Middle (MitM) attacks, where an attacker intercepts and possibly alters the communication between two parties, and ARP (Address Resolution Protocol) spoofing attacks, where the attacker links their MAC address to a legitimate IP address in the ARP cache of a target, diverting traffic intended for that IP address to themselves.

One of the easiest ways to execute is an Evil Twin Attack. 

## Bluetooh Artifacts

**Bluejacking** unsolicited messages sent to a Blue Tooth enabled device. 

**Bluesnarfing** unauthorized access to a device though a blue tooth connection. 

**BlueBorne**- allows attacker to gain complete control of a device without even being connected. 

**Spooftooph-** automates the spoofing or cloning of a Bluetooth devices name, class, and address. 

## RFIS and NFC Attacks

RFID- Radio Frequency Identification. Inventroy tracking. 

Shipping, employee badges, 

Like the Flipper Zero

NFC- Uses frequencies to send over a short distance. 